<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Pod::Advent 0.21 (Pod::Simple 3.07, Perl::Tidy 20090616) on 2010-12-19 19:20:29 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>2010 Perl Advent Calendar: On the 2nd day of Xmas Santa hits the bar pretty hard!</title>
<link rel="stylesheet" href="../style.css" type="text/css" />
<link rel="alternate" type="text/plain" href="mod18.pod" />
</head>
<body>
<h1><a href="../">Perl Advent Calendar 2010-12</a>-18</h1>
<h2 align="center">On the 2nd day of Xmas Santa hits the bar pretty hard!</h2>
<h3 align="center">by Adam Russell</h3>
<blockquote><p>Re: the ordinal in the title, <a href="http://en.wikipedia.org/wiki/Twelve_Days_of_Christmas">Christmastide</a> begins on the 25<sup>th</sup> and runs though Epiphany.</p>
</blockquote>
<p>Santa is truly a big picture guy. He prefers to get a sense of data quickly to make the important executive decisions, so the <a href="../../2010/16/">NMS</a> needs to be able to provide a summary of the available data. Nick also gets increasingly impatient as the big day fast approaches, and yearns for figures on how the tallies of who has been naughty and nice are shaping up in order to place the final just-in-time toy orders</p>
<p>As very straightforward module without much mystery to it, <tt><a href="http://search.cpan.org/perldoc?Text::BarGraph" title="Text::BarGraph">Text::BarGraph</a></tt> fits the bill nicely. Even Santa's most junior elf can whip up a small bit of code to query the NMS and produce an easy to decipher ASCII-art chart. The naughty nice tally is an ongoing work with data being fed constantly into a database from around the world. Since this reporter has been sworn to secrecy concerning this most valuable of data stores, the sample code below contains only some static sample data reflecting a recent snapshot.</p>
<p><tt style="display:block; color: gray; background: black"> unknown (129398430) <span style='color: darkblue'>*********</span><br /> naughty (233314664) <span style='color: darkblue'>**************</span><span style='color: darkgreen'>***</span><br /> &nbsp; &nbsp;nice (456089984) <span style='color: darkblue'>**************</span><span style='color: darkgreen'>***************</span><span style='color: #8b8b00'>****</span> </tt></p>
<p>Using <tt><span title="Text::BarGraph">Text::BarGraph</span></tt> is as simple as constructing a hash for your data and passing your BarGraph object's <tt><span class="i">graph</span><span class="s">(</span><span class="s">)</span></tt> method a reference to it. You can also <a href="#mod18.pl.13">change the graphing character</a>, <a href="#mod18.pl.16">sort records</a>, and set the max data value to <a href="#mod18.pl.15">scale the chart width</a>, among other adjustments. Perhaps of most use is the ability to display the graph bars in color&mdash;in segments as wide as 25% of the maximum width of the graph&mdash;if <a href="../../2004/2/">Term::ANSIColor</a> is available</p>
<a name="mod18.pl" id="mod18.pl"></a><h2><a href="mod18.pl">mod18.pl</a></h2><pre>
<a name="mod18.pl.1"></a>   1 <span class="c"># Let&#39;s make some ascii bar charts! </span>
<a name="mod18.pl.2"></a>   2 <span class="c"># Adam Russell ac.russell@live.com</span>
<a name="mod18.pl.3"></a>   3 
<a name="mod18.pl.4"></a>   4 <span class="k">use</span> <span class="w">Text::BarGraph</span><span class="sc">;</span>
<a name="mod18.pl.5"></a>   5 
<a name="mod18.pl.6"></a>   6 <span class="k">my</span><span class="s">(</span><span class="i">%naught_nice</span><span class="cm">,</span> <span class="i">$total</span><span class="s">)</span><span class="sc">;</span>
<a name="mod18.pl.7"></a>   7 <span class="k">my</span> <span class="i">$graph</span> = <span class="w">Text::BarGraph</span><span class="w">-&gt;new</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
<a name="mod18.pl.8"></a>   8 <span class="k">while</span> <span class="s">(</span><span class="k">my</span> <span class="i">$line</span> = <span class="q">&lt;DATA&gt;</span><span class="s">)</span> <span class="s">{</span>
<a name="mod18.pl.9"></a>   9     <span class="k">chomp</span> <span class="i">$line</span><span class="sc">;</span>
<a name="mod18.pl.10"></a>  10     <span class="k">my</span> <span class="i">@fields</span>=<span class="k">split</span><span class="s">(</span><span class="q">/:/</span><span class="cm">,</span><span class="i">$line</span><span class="s">)</span><span class="sc">;</span>
<a name="mod18.pl.11"></a>  11     <span class="i">$total</span> += <span class="i">$naught_nice</span>{<span class="i">$fields</span>[<span class="n">0</span>]}=<span class="i">$fields</span>[<span class="n">1</span>]<span class="sc">;</span>
<a name="mod18.pl.12"></a>  12 <span class="s">}</span>
<a name="mod18.pl.13"></a>  13 <span class="i">$graph</span><span class="i">-&gt;dot</span><span class="s">(</span><span class="q">&quot;*&quot;</span><span class="s">)</span><span class="sc">;</span>
<a name="mod18.pl.14"></a>  14 <span class="i">$graph</span><span class="i">-&gt;enable_color</span><span class="s">(</span><span class="n">1</span><span class="s">)</span><span class="sc">;</span>
<a name="mod18.pl.15"></a>  15 <span class="i">$graph</span><span class="i">-&gt;max_data</span><span class="s">(</span><span class="i">$total</span><span class="s">)</span><span class="sc">;</span>
<a name="mod18.pl.16"></a>  16 <span class="i">$graph</span><span class="i">-&gt;sortvalue</span><span class="s">(</span><span class="q">&quot;data&quot;</span><span class="s">)</span><span class="sc">;</span>
<a name="mod18.pl.17"></a>  17 <span class="k">print</span> <span class="i">$graph</span><span class="i">-&gt;graph</span><span class="s">(</span>\<span class="i">%naught_nice</span><span class="s">)</span><span class="sc">;</span>
<a name="mod18.pl.18"></a>  18 
<a name="__DATA__"></a>  19 <span class="k">__DATA__</span>
<a name="mod18.pl.20"></a>  20 <span class="q">naughty:233314664</span>
<a name="mod18.pl.21"></a>  21 <span class="q">nice:456089984</span>
<a name="mod18.pl.22"></a>  22 <span class="q">unknown:129398430</span>
</pre>
<div style="float: right; font-size: 10pt"><a href="mod18.pod">View Source (POD)</a></div><br />
</body>
</html>
